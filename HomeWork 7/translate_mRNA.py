# Make a program that translates mRNA into protein
# It should report the longest ORF in each mRNA
# Make sure you translate all 3 reading frames on both strands
# It should use argparse and your library, of course
import argparse
import mcb185
import statistics


parser = argparse.ArgumentParser(description = "This program will return the lonest open reaqding frame")
parser.add_argument('--file', required=True, type =str, metavar= '<str>', help="require Fasfa file")
arg = parser.parse_args()

def longest_orf(seq):
	max_orf= ""
	for i in range(len(seq)-2):
		start = None
		stop = None
		if seq[i:i+3] == 'ATG':
			start = i
			for j in range(i,len(seq)-2,3):
				codon = seq[j:j+3]
				if codon == 'TAA' or codon == 'TGA' or codon == 'TAG':
					stop = j
					break
		if stop != None:
			orf = seq[start:stop]
			if len(orf) > len(max_orf):
				max_orf = orf 
	return mcb185.translate(max_orf)

	
for name,seq in mcb185.read_fasta(arg.file):
	prot1 = longest_orf(seq)
	prot2 = longest_orf(mcb185.rev_comp(seq))
	print(f'>{name}')
	if len(prot1) >= len(prot2):
		print(prot1)
	else: 
		print(prot2)
	
	

	
"""
python3 translate_mRNA.py --fasta hs_rna.fa
>NM_001368885.1
MVAERTHKAAATGARGPGELGAPGTVALVAARAERGARLPSPGSCGLLTLALCSLALSLLAHFRTAELQARVLRLEAERG
EQQMETAILGRVNQLLDEKWKLHSRRRREAPKTSPGCNCPPGPPGPTGRPGLPGVKGQPGEKGSPGDAGLSIIGPRGPPG
QPGTRGFPGFPGPIGLDGKPGHPGPKGDMGLTGPPGQPGPQGQKGEKGQCGEYPHRLLPLLNSVRLAPPPVIKRRTFQGE
QSQASIQGPPGPPGPPGPSGPLGHPGLPGPMGPPGLPGPPGPKGDPGIQGYHGRKGERGMPGMPGKHGAKGAPGIAVAGM
KGEPGIPGTKGEKGAEGSPGLPGLLGQKGEKGDAGNSIGGGRGEPGPPGLPGPPGPKGEAGVDGQVGPPGQPGDKGERGA
AGEQGPDGPKGSKGEPGKGEMVDYNGNINEALQEIRTLALMGPPGLPGQIGPPGAPGIPGQKGEIGLPGPPGHDGEKGPR
GKPGDMGPPGPQGPPGKDGPPGVKGENGHPGSPGEKGEKGETGQAGSPGLQGVPGPKGEAGLDGAKGEKGFQGEKGDRGP
LGLPGTPGPIGVPGPAGPKGERGSKGDPGMTGPTGAAGLPGLHGPPGDKGNRGHRGFKGEKGEPGLPGLDGLDAPCPLGE
DGLPVQGCWNK
>NM_001368886.1
MGLTGPPGQPGPQGQKGEKGQCGEYPHRLLPLLNSVRLAPPPVIKRRTFQGEQSQASIQGPPGPPGPPGPSGPLGHPGLP
GPMGPPGLPGPPGPKGDPGIQGYHGRKGERGMPGMPGKHGAKGAPGIAVAGMKGEPGIPGTKGEKGAEGSPGLPGLLGQK
GEKGDAGNSIGGGRGEPGPPGLPGPPGPKGEAGVDGQVGPPGQPGDKGERGAAGEQGPDGPKGSKGEPGKGEMVDYNGNI
NEALQEIRTLALMGPPGLPGQIGPPGAPGIPGQKGEIGLPGPPGHDGEKGPRGKPGDMGPPGPQGPPGKDGPPGVKGENG
HPGSPGEKGEKGETGQAGSPVPGLPGPEGPPGPPGLQGVPGPKGEAGLDGAKGEKGFQGEKGDRGPLGLPGTPGPIGVPG
PAGPKGERGSKGDPGMTGPTGAAGLPGLHGPPGDKGNRGHRGFKGEKGEPGLPGLDGLDAPCPLGEDGLPVQGCWNK
>NR_148047.2
MILSWWLYVHKYIRHLSKLIECIIPRANSNVNYGLWIIMIHQCRFIDCSKCTTLVWDVDSGEAICVGVGGVWELSVLSSQ
FSCESKTALKK
>NR_148053.2
MILSWWLYVHKYIRHLSKLIECIIPRANSNVNYGLWIIMIHQCRFIDCSKCTTLVWDVDSGEAICVGVGGVWELSVLSSQ
FSCESKTALKK
>NM_001374457.1
MSTPDPPLGGTPRPGPSPGPGPSPGAMLGPSPGPSPGSAHSMMGPSPGPPSAGHPIPTQGPGGYPQDNMHQMHKPMESMH
EKGMSDDPRYNQMKGMGMRSGGHAGMGPPPSPMDQHSQGYPSPLGGSEHASSPVPASGPSSGPQMSSGPGGAPLDGADPQ
ALGQQNRGPTPFNQNQLHQLRAQIMAYKMLARGQPLPDHLQMAVQGKRPMPGMQQQMPTLPPPSVSATGPGPGPGPGPGP
GPGPAPPNYSRPHGMGGPNMPPPGPSGVPPGMPGQPPGGPPKPWPEGPMANAAAPTSTPQKLIPPQPTGRPSPAPPAVPP
AASPVMPPQTQSPGQPAQPAPMVPLHQKQSRITPIQKPRGLDPVEILQEREYRLQARIAHRIQELENLPGSLAGDLRTKA
TIELKALRLLNFQRQLRQEVVVCMRRDTALETALNAKAYKRSKRQSLREARITEKLEKQQKIEQERKRRQKHQEYLNSIL
QHAKDFKEYHRSVTGKIQKLTKAVATYHANTEREQKKENERIEKERMRRLMAEDEEGYRKLIDQKKDKRLAYLLQQTDEY
VANLTELVRQHKAAQVAKEKKKKKKKKKAENAEGQTPAIGPDGEPLDETSQMSDLPVKVIHVESGKILTGTDAPKAGQLE
AWLEMNPGYEVAPRSDSEESGSEEEEEEEEEEQPQAAQPPTLPVEEKKKIPDPDSDDVSEVDARHIIENAKQDVDDEYGV
SQALARGLQSYYAVAHAVTERVDKQSALMVNGVLKQYQIKGLEWLVSLYNNNLNGILADEMGLGKTIQTIALITYLMEHK
RINGPFLIIVPLSTLSNWAYEFDKWAPSVVKVSYKGSPAARRAFVPQLRSGKFNVLLTTYEYIIKDKHILAKIRWKYMIV
DEGHRMKNHHCKLTQVLNTHYVAPRRLLLTGTPLQNKLPELWALLNFLLPTIFKSCSTFEQWFNAPFAMTGEKVDLNEEE
TILIIRRLHKVLRPFLLRRLKKEVEAQLPEKVEYVIKCDMSALQRVLYRHMQAKGVLLTDGSEKDKKGKGGTKTLMNTIM
QLRKICNHPYMFQHIEESFSEHLGFTGGIVQGLDLYRASGKFELLDRILPKLRATNHKVLLFCQMTSLMTIMEDYFAYRG
FKYLRLDGTTKAEDRGMLLKTFNEPGSEYFIFLLSTRAGGLGLNLQSADTVIIFDSDWNPHQDLQAQDRAHRIGQQNEVR
VLRLCTVNSVEEKILAAAKYKLNVDQKVIQAGMFDQKSSSHERRAFLQAILEHEEQDEEEDEVPDDETVNQMIARHEEEF
DLFMRMDLDRRREEARNPKRKPRLMEEDELPSWIIKDDAEVERLTCEEEEEKMFGRGSRHRKEVDYSDSLTEKQWLKAIE
EGTLEEIEEEVRQKKSSRKRKRDSDAGSSTPTTSTRSRDKDDESKKQKKRGRPPAEKLSPNPPNLTKKMKKIVDAVIKYK
DSSSGRQLSEVFIQLPSRKELPEYYELIRKPVDFKKIKERIRNHKYRSLNDLEKDVMLLCQNAQTFNLEGSLIYEDSIVL
QSVFTSVRQKIEKEDDSEGEESEEEEEGEEEGSESESRSVKVKIKLGRKEKAQDRLKGGRRRPSRGSRAKPVVSDDDSEE
EQEEDRSGSGSEED
>NR_148052.2
MILSWWLYVHKYIRHLSKLIECIIPRANSNVNYGLWIIMIHQCRFIDCSKCTTLVWDVDSGEAICVGVGGVWELSVLSSQ
FSCESKTALKK
>NR_137288.2
MASSNPPPQPAIGDQLVPGVPGPSSEAEDDPGEAFEFDDSDDEEDTSAALGVPSLAPERDTDPPLIHLDSIPVTDPDPAA
APPGTGVPAWVSNGDAADAAFSGARHSSWKRKSSRRIDRFTFPALEEDVIYDDVPCESPDAHQPGAERNLLYEDAHRAGA
PRQAEDLGWSSSEFESYSEDSGEEAKPEVEVEPAKHRVSFQPKMTQLMKAAKSGTKDGLEKTRMAVMRKVSFLHRKDVLG
DSEEEDMGLLEVSVSDIKPPAPELGPMPEGLSPQQVVRRHILGSIVQSEGSYVESLKRILQDYRNPLMEMEPKALSARKC
QVVFFRVKEILHCHSMFQIALSSRVAEWDSTEKIGDLFVASFSKSMVLDVYSDYVNNFTSAMSIIKKACLTKPAFLEFLK
RRQVCSPDRVTLYGLMVKPIQRFPQFILLLQDMLKNTPRGHPDRLSLQLALTELETLAEKLNEQKRLADQVAEIQQLTKS
VSDRSSLNKLLTSGQRQLLLCETLTETVYGDRGQLIKSKERRVFLLNDMLVCANINFKPANHRGQLEISSLVPLGPKYVV
KWNTALPQVQVVEVGQDGGTYDKDNVLIQHSGAKKASASGQAQNKVYLGPPRLFQELQDLQKDLAVVEQITLLISTLHGT
YQNLNMTVAQDWCLALQRLMRVKEEEIHSANKCRLRLLLPGKPDK
>NR_132740.2
MGDEKDSWKVKTLDEILQEKKRRKEQEEKAEIKRLKNSDDRDSKRDSLEEGELRDHCMEITIRNSPYRREDSMEDRGEED
DSLAIKPPQQMSRKEKVHHRKDEKRKEKCRHHSHSAEGGKHARVKEREHERRKRHREEQDKARREWERQKRREMAREHSR
RERDRLEQLERKRERERKMREQQKEQREQKERERRAEERRKEREARREVSAHHRTMREDYSDKVKASHWSRSPPRPPRER
FELGDGRKPGEARPAPAQKPAQLKEEKMEERDLLSDLQDISDSERKTSSAESSSAESGSGSEEEEEEEEEEEEEGSTSEE
SEEEEEEEEEEEEETGSNSEEASEQSAEEVSEEEMSEDEERENENHLLVVPESRFDRDSGESEEAEEEVGLPERRGVPVP
EQDRGGHLWSGLQSKRQENR
>NR_037687.2
MGTRQKELLDIDSSSVILEDGITKLNTIGHYEISNGSTIKVFKKIANFTSDVEYSDDHCHLILPDSEAFQDVQGKRHRGK
HKFKVKEMYLTKLLSTKVAIHSVLEKLFRSIWSLPNSRAPFAIKYFFDFLDAQAENKKITDPDVVHIWKTNSLPLRFWVN
ILKNPQFVFDIKKTPHIDGCLSVIAQAFMDAFSLTEQQLGKEAPTNKLLYAKDIPTYKEEVKSYYKAIRDLPPLSSSEME
EFLTQESKKHENEFNEEVALTEIYKYIVKYFDEILNKLERERGLEEAQKQLLHVKVLFDEKKKCKWM
>NR_137287.2
MASSNPPPQPAIGDQLVPGVPGPSSEAEDDPGEAFEFDDSDDEEDTSAALGVPSLAPERDTDPPLIHLDSIPVTDPDPAA
APPGTGVPAWVSNGDAADAAFSGARHSSWKRKSSRRIDRFTFPALEEDVIYDDVPCESPDAHQPAGAERNLLYEDAHRAG
APRQAEDLGWSSSEFESYSEDSGEEAKPEVEVEPAKHRVSFQPKLSPDLTRLKERYARTKRDILALRVGGRDMQELKHKY
DCKMTQLMKAAKSGTKDGLEKTRMAVMRKVSFLHRKDVLGDSEEEDMGLLEVSVSDIKPPAPELGPMPEGLSPQQVVRRH
ILGSIVQSEGSYVESLKRILQDYRNPLMEMEPKALSARKCQVVFFRVKEILHCHSMFQIALSSRVAEWDSTEKIGDLFVA
SFSKSMVLDVYSDYVNNFTSAMSIIKKACLTKPAFLEFLKRRQVCSPDRVTLYGLMVKPIQRFPQFILLLQDMLKNTPRG
HPDRLSLQLALTELETLAEKLNEQKRLADQVAEIQQLTKSVSDRSSLNKLLTSGQRQLLLCETLTETVYGDRGQLIKSKE
RRVFLLNDMLVCANINFKPANHRGQLEISSLVPLGPKYVVKWNTALPQVQVVEVGQDGGTYDKDNVLIQHSGAKKASASG
QAQNKVYLGPPRLFQELQDLQKDLAVVEQITLLISTLHGTYQNLNMTVAQDWCLALQRLMRVKEEEIHSANKCRLRLLLP
GKPDK
>NR_157088.2
MADDFGFFSSSESGAPEAAEEDPAAAFLAQQESEIAGIENDEGFGAPAGSHAAPAQPGPTSGAGSEDMGTTVNGDVFQPV
HHQRVQLQTQLPIQPKDEPAHNYSSSIWHSQGQGQKGPAGLRLPTSAQILSPFP
>NR_132739.2
MGDEKDSWKVKTLDEILQEKKRRKEQEEKAEIKRLKNSDDRDSKRDSLEEGELRDHCMEITIRNSPYRREDSMEDRGEED
DSLAIKPPQQMSRKEKVHHRKDEKRKEKCRHHSHSAEGGKHARVKEREHERRKRHREEQDKARREWERQKRREMAREHSR
RERDRLEQLERKRERERKMREQQKEQREQKERERRAEERRKEREARREVSAHHRTMREDYSDKVKASHWSRSPPRPPRER
FELGDGRKPVKEEKMEERDLLSDLQDISDSERKTSSAESSSAESGSGSEEEEEEEEEEEEEGSTSEESEEEEEEEEEEEE
ETGSNSEEASEQSAEEVSEEEMSEDEERENENHLLVVPESRFDRDSGESEEAEEEVGLPERRGVPVPEQDRGGHLWSGLQ
SKRQENR
>NR_045724.2
MADDFGFFSSSESGAPEAAEEDPAAAFLAQQESEIAGIENDEGFGAPAGSHAAPAQPGPTSGAGSEDMGTTVNGDVFQPV
HHQRVQLQTQLPIQPKDEPAHNYSSSIWHSQGQGQKGPAGLRLPTSAQILSPFP
>NR_038863.2
MKSGEDGCPSPKRERICPSLFILLEPLTDWMMPVHIDEGGSSVLSLLLQMLVSSENSLTDPPRNVLPAIWLSLNPVKLTH
KINHHRMLFGFRF
>NR_168349.1
MFGACYKQPLKPSGSEPPAEECRMTPRHAGCDVTEMQRILSQPTFTEHLLRAVCTKLANMYSTSTDCREHCRRGMKAKQL
KAEAGRLTLFADTLYFVWQPYSPLNHLFELFRVMDIVKVRSQMCGNNNAKFKIVVSMEHEGEKHHQGSCQRKGVPIQTPR
EHSWISCKKEFEANP
>NR_168346.1
MFGACYKQPLKPSGSEPPAEECRMTPRHAGCDVTEMQRILSQPTFTEHLLRAVCLVNGKGSLSRPQESILGSLARKNLRR
IHRVSLVMCVRPLSPSKAIISPVTCMYTSRWPEASEESQKK
>NR_168352.1
MFGACYKQPLKPSGSEPPAEECRMTPRHAGCDVTEMQRILSQPTFTEHLLRAVCTKLANMYSTSTDCREHCRRGMKAKQL
KAEAGRSCQRKGVPIQTPREHSWISCKKEFEANP
>NR_168351.1
MFGACYKQPLKPSGSEPPAEECRMTPRHAGCDVTEMQRILSQPTFTEHLLRAVCLVNGKGSLSRPQESILGSLARKNLRR
IHRVSKASYFYIEGCTLTDQTMLSDVCQTSEPKQSHHIPCDLHVYIQMA
>NR_168350.1
MFGACYKQPLKPSGSEPPAEECRMTPRHAGCDVTEMQRILSQPTFTEHLLRAVCTKLANMYSTSTDCREHCRRGMKAKQL
KAEAGRLTLFADTLYFVWQPYSPLNHLFELFRVMDIVKVRSQMCGNNNAKFKIVVSMEHEGEKHHQGSCQRKGVPIQTPR
EHSWISCKKEFEANP
>NR_168347.1
MFGACYKQPLKPSGSEPPAEECRMTPRHAGCDVTEMQRILSQPTFTEHLLRAVCTKLANMYSTSTDCREHCRRGMKAKQL
KAEAGRSCQRKGVPIQTPREHSWISCKKEFEANP
>NR_168348.1
MSSVKAGTGPFHFFCDSSLASGHLDVYMQVTGDMMALLGLRGLTHITKLTLWIRLKFFLARDPRMLSWGLDRDPFPLTRR
HEVDAQ
>NR_123717.2
MPLVEVQLLLLLYTSMRSGLGKKDKEVMTDTQWKPHIVSWQTEERDVGSSASFDCKVPGFCCTFAHAHGWWEERGIAETH
RRGYRVGEKESRRANTPKEQGQLHLVSLRGTETQE
>NR_168381.1
MLHGRRLGAKATLPHPPLWEAPERGPEIVPHSPPGKEARPPWTEATRSPGRKERTHRPPCGGGRTWSPVVSGRGGISLPV
GLQC
>NR_168373.1
MWLQVRPMPRQFCTAWHMALILSLERNVAVGPASHGVKLHLLLLYSGSNLFLILVL
>NR_168385.1
MLRCLGVSGWGRKDQGTHVLRPRRGVPGRRDFRSLPSAGDLGLCRSPPGSSIRAGVLPAAPKVAWGRWGVPEGMEGPCLG
KEGFRCLWGFSAEPGSPEQTRTELPKPDREGALVASGIHVVDRESARSSPPQ
"""
	